/*
 * ledTask.c
 *
 *  Created on: Oct 11, 2021
 *      Author: Jorlu
 */

#include "ledTask.h"

//Ejercicio 1

void CreateLedTaskEj1(){
	xTaskCreate(ledToggleTaskEj1, "ledToggleTaskLed1", 128, 1, 1, NULL);
	xTaskCreate(ledToggleTaskEj1, "ledToggleTaskLed2", 128, 2, 1, NULL);
}

void ledToggleTaskEj1(void *pArg){
	int numLed = (int) pArg;
	while(1){
		LED_TOGGLE(numLed);
		vTaskDelay(100);
	}
}

//Ejercicio 2

void CreateLedTaskEj2(){
	xTaskCreate(ledToggleTaskEj2, "ledToggleTaskLed1", 128, 1, 1, NULL);
	xTaskCreate(ledToggleTaskEj2, "ledToggleTaskLed2", 128, 2, 1, NULL);
}

void ledToggleTaskEj2(void *pArg){
	int numLed = (int) pArg;
	while(1){
		LED_TOGGLE(numLed);
		vTaskDelay(200 + 100 * (numLed-1));
	}
}

//Ejercicio 3

void CreateLedTaskEj3(){
	xTaskCreate(ledToggleTaskEj3, "ledToggleTaskLed1", 128, 1, 1, NULL);
}

void ledToggleTaskEj3(void *pArg){
	int numLed = (int) pArg;
	if(numLed == 1){
		for(int i = 0; i < 5; i++){
			LED_TOGGLE(numLed);
			vTaskDelay(200 + 100 * (numLed-1));
		}
		xTaskCreate(ledToggleTaskEj3, "LedToggleTaskLed2", 123, numLed+1, 1, NULL);
		vTaskDelete(NULL);
	}else if (numLed ==2){
		while(1){
			LED_TOGGLE(numLed);
			vTaskDelay(200 + 100 * (numLed-1));
		}
	}
}

//Ejercicio 4

void CreateLedTaskEj4(){
	xTaskCreate(ledAnimationTaskEj4, "LedToggleTaskLed0", 123, NULL, 1, NULL);
}

void CreateLedTask1Ej4(){
	xTaskCreate(ledToggleTaskEj4, "LedToggleTaskLed1", 123, 1, 1, NULL);
}

void CreateLedTask2Ej4(){
	xTaskCreate(ledToggleTaskEj4, "LedToggleTaskLed2", 123, 2, 10, NULL);
}

void ledAnimationTaskEj4(){
	while(1){
		if(ReadButton()){
			CreateLedTask1Ej4();
			CreateLedTask2Ej4();
		}
	}
}

void ledToggleTaskEj4(void *pArg){
	int numLed = (int) pArg;
	while(1){
		LED_TOGGLE(numLed);
		vTaskDelay(200 + 100 * (numLed-1));
	}
}
